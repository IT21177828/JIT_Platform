import { useEffect, useRef } from "react";
import { gsap } from "gsap";
import "./Loading.css";

export default function Loading() {
  const svgRef = useRef<SVGSVGElement>(null);

  useEffect(() => {
    const svg = svgRef.current;
    if (!svg) return;

    const path = svg.querySelector("path");
    if (!path) return;

    const length = path.getTotalLength();
    const duration = length / 800;

    console.log("Path Length:", length);
    console.log("duration:", duration);

    // Set initial hidden state
    gsap.set(path, {
      strokeDasharray: length,
      strokeDashoffset: length,
      opacity: 1,
      visibility: "visible",
    });

    // Animate drawing
    gsap.to(path, {
      strokeDashoffset: 0,
      duration: duration,
      ease: "power2.inOut",
    });
  }, []);

  return (
    <div className="bg-blue-light-950 fixed flex flex-col items-center justify-center h-screen w-full opacity-60">
      <div className="flex flex-col items-center justify-center w-fit">
        <svg
          ref={svgRef}
          className="w-[60%] h-32"
          viewBox="-250 0 1800 150"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            id="svg-loading"
            d="M1186.35 63.75V111h-2.85V63.45a54 54 0 0 0-.732-9.198q-1.612-9.304-6.768-15.027-7.5-8.325-20.55-8.325a31.3 31.3 0 0 0-10.583 1.722 27.1 27.1 0 0 0-11.467 7.953Q1125 50.25 1125 68.7V111h-2.85V63.45a54 54 0 0 0-.732-9.198q-1.612-9.304-6.768-15.027-7.5-8.325-20.55-8.325a31.9 31.9 0 0 0-10.309 1.597 26.7 26.7 0 0 0-11.816 8.078 31.2 31.2 0 0 0-5.906 10.784q-1.512 4.622-2.079 10.24a71 71 0 0 0-.34 7.101V111h-3V30h3v21.45a36.7 36.7 0 0 1 3.133-8.237 26.3 26.3 0 0 1 8.042-9.238Q1083 28.2 1094.1 28.2a34 34 0 0 1 10.584 1.591 29.2 29.2 0 0 1 8.991 4.784q7.95 6.2 10.297 18.571a49 49 0 0 1 .128.704 40.4 40.4 0 0 1 2.761-8.594q2.944-6.413 8.04-10.394a26 26 0 0 1 .374-.287l.133-.099q7.116-5.295 16.492-6.123a40 40 0 0 1 3.55-.153 33.7 33.7 0 0 1 10.894 1.694 28.56 28.56 0 0 1 11.306 7.156 27.66 27.66 0 0 1 6.387 10.685q1.446 4.257 1.988 9.449a63 63 0 0 1 .325 6.566Zm-617.7-9V30h2.85v81h-2.85V86.25q-3.3 11.25-12.975 18.525a35.9 35.9 0 0 1-16.516 6.762 48 48 0 0 1-7.109.513 45.3 45.3 0 0 1-11.87-1.503 38.2 38.2 0 0 1-8.68-3.522q-9-5.025-13.95-14.4a41.8 41.8 0 0 1-4.133-12.323 56.3 56.3 0 0 1-.817-9.802 55.4 55.4 0 0 1 1.016-10.862 41.3 41.3 0 0 1 3.934-11.263q4.95-9.375 13.95-14.4a39.7 39.7 0 0 1 15.276-4.749 49 49 0 0 1 5.274-.276q13.95 0 23.625 7.275T568.65 54.75ZM177.9 5.4h64.5v2.7h-30.75V111h-3V8.1H177.9zm563.25 18.9V30h23.25v3.15h-23.25V111h-3V33.15h-13.2V30h13.2v-5.7q0-7.959 2.512-13.28A17.7 17.7 0 0 1 744.15 6a17.3 17.3 0 0 1 5.946-3.772Q755.716 0 764.4 0v3a54 54 0 0 0-6.028.314q-6.428.73-10.172 3.157a12.3 12.3 0 0 0-1.95 1.554 14.9 14.9 0 0 0-3.395 5.348q-.906 2.35-1.33 5.287a39.5 39.5 0 0 0-.375 5.64Zm-68.7 8.7h-25.5v56.7q0 6.805 1.414 10.653a13 13 0 0 0 .236.597 11 11 0 0 0 1.975 3.145 9.6 9.6 0 0 0 3.275 2.33 15.6 15.6 0 0 0 2.812.897q2.91.656 6.971.677l.267.001h8.55v3h-8.85a36 36 0 0 1-5.368-.369q-2.701-.406-4.85-1.258a13.4 13.4 0 0 1-4.857-3.173q-4.575-4.8-4.575-16.5V33h-13.2v-3h13.2V9.3h3V30h25.5zM44.4 5.4h3v84.15a25.7 25.7 0 0 1-1.163 7.885 21.2 21.2 0 0 1-4.912 8.24 19.9 19.9 0 0 1-10.296 5.689 29.8 29.8 0 0 1-6.579.686 30.5 30.5 0 0 1-7.415-.851 20.54 20.54 0 0 1-10.66-6.349Q.528 98.246.044 87.099A47 47 0 0 1 0 85.05h3a35.6 35.6 0 0 0 .81 7.796 25.2 25.2 0 0 0 4.29 9.604 16.12 16.12 0 0 0 8.777 5.93q3.354.97 7.573.97 10.65 0 15.3-5.925T44.4 89.55zm283.95 58.05h-23.7V111h-3V5.4h26.7a63 63 0 0 1 9.289.639q10.474 1.572 16.286 7.011a25 25 0 0 1 7.295 13.056 37.8 37.8 0 0 1 .88 8.394q0 10.799-4.71 17.549a21.7 21.7 0 0 1-3.84 4.201q-6.587 5.547-17.981 6.82a65 65 0 0 1-7.219.38Zm520.525 46.734a43.3 43.3 0 0 0 12.875 1.866 48 48 0 0 0 3.461-.123A39.9 39.9 0 0 0 882 107.025q9-5.025 14.1-14.4a40.5 40.5 0 0 0 4.016-11.088A53.7 53.7 0 0 0 901.2 70.5q0-12.75-5.1-22.125t-14.1-14.4a38.4 38.4 0 0 0-7.375-3.159 43.3 43.3 0 0 0-12.875-1.866 48 48 0 0 0-3.461.123 39.9 39.9 0 0 0-16.789 4.902q-9 5.025-14.175 14.4a40 40 0 0 0-4.075 11.088 53 53 0 0 0-1.1 11.037 54.5 54.5 0 0 0 .728 9.088 40.8 40.8 0 0 0 4.447 13.037q5.175 9.375 14.175 14.4a38.4 38.4 0 0 0 7.375 3.159ZM1001.4 28.2v3.3h-1.35a36.4 36.4 0 0 0-11.433 1.735 31.1 31.1 0 0 0-10.242 5.69q-8.925 7.425-8.925 23.925V111h-3V30h3v19.65a26.86 26.86 0 0 1 5.941-12.212q8.192-9.238 26.009-9.238ZM568.65 70.5a48 48 0 0 0-1.181-10.856 38 38 0 0 0-3.544-9.469q-4.725-8.775-13.05-13.65a35.8 35.8 0 0 0-16.074-4.789 44 44 0 0 0-2.751-.086 44.6 44.6 0 0 0-9.764 1.022 34.3 34.3 0 0 0-9.511 3.628Q504.6 40.95 500.1 49.725a39.8 39.8 0 0 0-3.728 11.39 54.5 54.5 0 0 0-.772 9.385 54 54 0 0 0 .861 9.883 39.6 39.6 0 0 0 3.639 10.892q4.5 8.775 12.675 13.425a35.1 35.1 0 0 0 11.832 4.075 46.4 46.4 0 0 0 7.443.575 38.8 38.8 0 0 0 11.702-1.719 34.6 34.6 0 0 0 7.123-3.156q8.325-4.875 13.05-13.65a39.3 39.3 0 0 0 4.24-13.21 51 51 0 0 0 .485-7.115Zm293.1 38.85q9.75 0 18-4.275a32.3 32.3 0 0 0 12.026-10.869A39 39 0 0 0 893.1 92.1a35.5 35.5 0 0 0 3.979-10.429q.972-4.444 1.101-9.581a63 63 0 0 0 .02-1.59q0-12.9-5.1-21.6a35 35 0 0 0-7.14-8.748 31.3 31.3 0 0 0-6.21-4.227q-8.25-4.275-18-4.275t-18.075 4.275a32.1 32.1 0 0 0-12.1 10.927 39 39 0 0 0-1.325 2.123 36.2 36.2 0 0 0-4.053 10.786q-1.047 4.962-1.047 10.739 0 11.922 4.459 20.369a33 33 0 0 0 .641 1.156 34.7 34.7 0 0 0 7.084 8.738 31 31 0 0 0 6.341 4.312q8.325 4.275 18.075 4.275ZM424.35 0h3v111h-3zm-308.7 5.4h3V111h-3zm212.7 3h-23.7v51.9h23.7a61.5 61.5 0 0 0 8.38-.53q9.458-1.306 14.662-5.831a18 18 0 0 0 .433-.389 22 22 0 0 0 6.454-11.412 33.5 33.5 0 0 0 .821-7.638q0-12.9-7.2-19.5a21.1 21.1 0 0 0-6.853-4.086q-6.18-2.352-15.411-2.504a78 78 0 0 0-1.286-.01Z"
            stroke="#fff"
            strokeWidth="8"
            fill="none"
          />
        </svg>
        <div className="glow-line-container">
          <div className="glow-line"></div>
        </div>
      </div>
    </div>
  );
}
